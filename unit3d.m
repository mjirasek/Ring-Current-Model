function [Bxt,Byt,Bzt] = unit3d(a1,a2,b1,b2,c1,c2,t,x,y,z)
% Evaluation of the integral of the Biot-Savart law
% for the Bx,By,Bz component of induced field. The
% a1,a2,b1,b2,c1,c2 are geomterical factors as defined
% in the equation S2. 

Bzt = (...
    ((a2*b1-b1*x+a1*(-b2+y))* ...
    (a1^2*t+b1^2*t+a1*(a2-x)+b1*(b2-y) ...
    +c1*(c2+c1*t-z))) ...
    ) ...
    / ( ...
    sqrt(a2^2+b2^2+c2^2+2*a1*a2*t+2*b1*b2*t ...
    +2*c1*c2*t+a1^2*t^2+b1^2*t^2+c1^2*t^2-2*a2*x ...
    -2*a1*t*x+x^2-2*b2*y-2*b1*t*y+y^2-2*c2*z-2*c1*t*z+z^2) ...
    *(b2^2*c1^2+a2^2*(b1^2+c1^2)-2*b1*b2*c1*c2+b1^2*c2^2 ...
    +b1^2*x^2+c1^2*x^2-2*b2*c1^2*y+2*b1*c1*c2*y ...
    +c1^2*y^2+2*a1*x*(b1*(b2-y)+c1*(c2-z)) ...
    -2*a2*((b1^2+c1^2)*x+a1*b1*(b2-y)+a1*c1*(c2-z)) ...
    +2*b1*b2*c1*z-2*b1^2*c2*z-2*b1*c1*y*z+b1^2*z^2 ...
    +a1^2*(b2^2+c2^2-2*b2*y+y^2-2*c2*z+z^2)) ...
    );

Byt = (...
    ((-a2*c1+c1*x+a1*(c2-z))*...
    (a1^2*t+b1^2*t+a1*(a2-x)+b1*(b2-y) ...
    +c1*(c2+c1*t-z)))...
    ) ...
    / ( ...
    sqrt(a2^2+b2^2+c2^2+2*a1*a2*t+2*b1*b2*t ...
    +2*c1*c2*t+a1^2*t^2+b1^2*t^2+c1^2*t^2-2*a2*x ...
    -2*a1*t*x+x^2-2*b2*y-2*b1*t*y+y^2-2*c2*z-2*c1*t*z+z^2) ...
    *(b2^2*c1^2+a2^2*(b1^2+c1^2)-2*b1*b2*c1*c2+b1^2*c2^2 ...
    +b1^2*x^2+c1^2*x^2-2*b2*c1^2*y+2*b1*c1*c2*y ...
    +c1^2*y^2+2*a1*x*(b1*(b2-y)+c1*(c2-z)) ...
    -2*a2*((b1^2+c1^2)*x+a1*b1*(b2-y)+a1*c1*(c2-z)) ...
    +2*b1*b2*c1*z-2*b1^2*c2*z-2*b1*c1*y*z+b1^2*z^2 ...
    +a1^2*(b2^2+c2^2-2*b2*y+y^2-2*c2*z+z^2)) ...
    );

Bxt = (...
    ((a1^2*t + b1^2*t + a1*(a2 - x) + b1*(b2 - y) + ...
    c1*(c2 + c1*t - z))*...
    (b2*c1 - c1*y + ...
    b1*(-c2 + z)))...
    )...
    / ( ...
    sqrt(a2^2+b2^2+c2^2+2*a1*a2*t+2*b1*b2*t ...
    +2*c1*c2*t+a1^2*t^2+b1^2*t^2+c1^2*t^2-2*a2*x ...
    -2*a1*t*x+x^2-2*b2*y-2*b1*t*y+y^2-2*c2*z-2*c1*t*z+z^2) ...
    *(b2^2*c1^2+a2^2*(b1^2+c1^2)-2*b1*b2*c1*c2+b1^2*c2^2 ...
    +b1^2*x^2+c1^2*x^2-2*b2*c1^2*y+2*b1*c1*c2*y ...
    +c1^2*y^2+2*a1*x*(b1*(b2-y)+c1*(c2-z)) ...
    -2*a2*((b1^2+c1^2)*x+a1*b1*(b2-y)+a1*c1*(c2-z)) ...
    +2*b1*b2*c1*z-2*b1^2*c2*z-2*b1*c1*y*z+b1^2*z^2 ...
    +a1^2*(b2^2+c2^2-2*b2*y+y^2-2*c2*z+z^2)) ...
    );

end


